{% extends "sales/base.html" %}

{% block extrahead %}
    <script type="text/javascript">
    $(function(){
        $('.sku').hover(
            function () {
                var skuid = $(this).data('skuid');
                $("." + skuid).addClass('selected');
            }, 
            function () {
                var skuid = $(this).data('skuid');
                $("." + skuid).removeClass('selected');
            }
        ).click(
            function () {
                alert('add code to retrieve cut order details');
            }
        );
    });
    </script>
    
    <style type="text/css">
        .selected {
            background-color: blue;
            color: white;
            cursor: pointer;
        }
    </style>
{% endblock %}

{% block body %}
    {% regroup shirtorderskus by ShirtOrder.PONumber as purchaseorders %}
    {% for po in purchaseorders %}
        <h4>Purchase Order {{ po.grouper }}</h4>
        {% regroup po.list by ShirtPrice.ShirtStyle as styles %}
        {% for style in styles %}
            {% regroup style.list by Color as stylecolors %}
            {% for stylecolor in stylecolors %}
                <div style="float:left;margin-left:10px;">
                <table style="width:auto;" class="table table-bordered table-condensed">
                    <tr><th colspan="{{ stylecolor.list|length|add:"1" }}">{{ style.grouper }} {{ stylecolor.grouper }}</th></tr>
                    <tr>
                        <th></th>
                        {% for sku in stylecolor.list %}
                            <th class="sku {{ sku.pk }}" data-skuid="{{ sku.pk }}">{{ sku.ShirtPrice.ShirtSize.ShirtSizeAbbr }}</th>
                        {% endfor %}
                    </tr>
                    <tr>
                        <th>On Order</th>
                        {% for sku in stylecolor.list %}
                            <td class="sku {{ sku.pk }}" data-skuid="{{ sku.pk }}">{{ sku.OrderQuantity }}</td>
                        {% endfor %}
                    </tr>
                    <tr>
                        <th>Available</th>
                        {% for sku in stylecolor.list %}
                            <td class="sku {{ sku.pk }}" data-skuid="{{ sku.pk }}">{{ sku.availableshirts }}</td>
                        {% endfor %}
                    </tr>
                </table></div>
            {% endfor %}
        {% endfor %}
        <div style="clear:both;"></div>
    {% endfor %}

{% endblock %}
